<svg xmlns="http://www.w3.org/2000/svg" width="1160" height="520" viewBox="0 0 1160 520">
  <defs>
    <style>
      .box { fill: #ffffff; stroke: #111827; stroke-width: 2; rx: 14; }
      .title { font: 700 18px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; fill: #111827; }
      .text { font: 400 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; fill: #374151; }
      .small { font: 400 13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; fill: #374151; }
      .arrow { stroke: #111827; stroke-width: 2.5; fill: none; marker-end: url(#arrowhead); }
      .chip { fill: #EEF2FF; stroke: #6366F1; stroke-width: 1.5; rx: 10; }
      .chipText { font: 600 12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; fill: #4338CA; }
      .bg { fill: #F9FAFB; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#111827" />
    </marker>
  </defs>

  <rect class="bg" x="0" y="0" width="1160" height="520" />

  <!-- Input -->
  <rect class="box" x="40" y="40" width="320" height="180" rx="14" />
  <text class="title" x="65" y="80">Input</text>
  <text class="text" x="65" y="120">ticker (ex: PETR4, BBDC3)</text>
  <text class="text" x="65" y="145">current_year</text>

  <!-- News collection -->
  <rect class="box" x="420" y="40" width="320" height="180" rx="14" />
  <text class="title" x="445" y="80">1) news_collection_task</text>
  <text class="text" x="445" y="110">Agent: news_researcher</text>
  <rect class="chip" x="445" y="130" width="140" height="26" rx="10" />
  <text class="chipText" x="457" y="148">Tool: news_search</text>
  <text class="small" x="445" y="178">Returns: title, source, published, url</text>

  <!-- News synthesis -->
  <rect class="box" x="800" y="40" width="320" height="180" rx="14" />
  <text class="title" x="825" y="80">2) news_synthesis_task</text>
  <text class="text" x="825" y="110">Agent: news_synthesizer</text>
  <text class="small" x="825" y="140">Themes, Catalysts, Risks,</text>
  <text class="small" x="825" y="160">Sentiment, Watchlist</text>

  <!-- Fundamentals -->
  <rect class="box" x="40" y="270" width="320" height="180" rx="14" />
  <text class="title" x="65" y="310">3) fundamentals_task</text>
  <text class="text" x="65" y="340">Agent: fundamentals_analyst</text>
  <rect class="chip" x="65" y="360" width="190" height="26" rx="10" />
  <text class="chipText" x="77" y="378">Tool: stock_fundamentals</text>
  <text class="small" x="65" y="408">Sources: yfinance + Fundamentus</text>

  <!-- Final rating -->
  <rect class="box" x="420" y="270" width="320" height="180" rx="14" />
  <text class="title" x="445" y="310">4) investment_rating_task</text>
  <text class="text" x="445" y="340">Agent: investment_rater</text>
  <text class="small" x="445" y="370">Final rating + justification</text>
  <text class="small" x="445" y="392">(pt-BR markdown report)</text>

  <!-- Output -->
  <rect class="box" x="800" y="270" width="320" height="180" rx="14" />
  <text class="title" x="825" y="310">Output</text>
  <text class="small" x="825" y="350">reports/&lt;TICKER&gt;_investment_report.md</text>

  <!-- Arrows -->
  <path class="arrow" d="M 360 130 L 420 130" />
  <path class="arrow" d="M 740 130 L 800 130" />

  <path class="arrow" d="M 960 220 L 960 245 L 200 245 L 200 270" />

  <path class="arrow" d="M 360 360 L 420 360" />

  <path class="arrow" d="M 740 360 L 800 360" />
</svg>
